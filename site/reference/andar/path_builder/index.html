
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://fabarca.github.io/andar/reference/andar/path_builder/">
      
      
        <link rel="prev" href="../">
      
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>path_builder - Andar Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#andar.path_builder" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Andar Docs" class="md-header__button md-logo" aria-label="Andar Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Andar Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              path_builder
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Andar Docs" class="md-nav__button md-logo" aria-label="Andar Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Andar Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome to Andar Docs
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>andar
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>andar
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    path_builder
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    path_builder
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#andar.path_builder.FieldConf" class="md-nav__link">
    <span class="md-ellipsis">
      
        FieldConf
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FieldConf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.FieldConf.replace" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder" class="md-nav__link">
    <span class="md-ellipsis">
      
        PathBuilder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PathBuilder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.assert_fields_bijection" class="md-nav__link">
    <span class="md-ellipsis">
      
        assert_fields_bijection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.assert_path_bijection" class="md-nav__link">
    <span class="md-ellipsis">
      
        assert_path_bijection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.assign_groupname_pattern_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        assign_groupname_pattern_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.check_parent_path_template" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_parent_path_template
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.check_template_fields" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_template_fields
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.get_parent_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_parent_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.get_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.get_template_fields_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_template_fields_names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.parse_fields" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_fields
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.parse_file_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_file_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.prepare_fields_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        prepare_fields_values
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.process_parsed_fields_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        process_parsed_fields_values
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.replace" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#andar.path_builder.SafePatterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        SafePatterns
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#andar.path_builder.FieldConf" class="md-nav__link">
    <span class="md-ellipsis">
      
        FieldConf
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FieldConf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.FieldConf.replace" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder" class="md-nav__link">
    <span class="md-ellipsis">
      
        PathBuilder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PathBuilder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.assert_fields_bijection" class="md-nav__link">
    <span class="md-ellipsis">
      
        assert_fields_bijection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.assert_path_bijection" class="md-nav__link">
    <span class="md-ellipsis">
      
        assert_path_bijection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.assign_groupname_pattern_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        assign_groupname_pattern_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.check_parent_path_template" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_parent_path_template
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.check_template_fields" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_template_fields
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.get_parent_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_parent_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.get_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.get_template_fields_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_template_fields_names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.parse_fields" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_fields
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.parse_file_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_file_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.prepare_fields_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        prepare_fields_values
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.process_parsed_fields_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        process_parsed_fields_values
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.replace" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#andar.path_builder.PathBuilder.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#andar.path_builder.SafePatterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        SafePatterns
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<div class="doc doc-object doc-module">



<h1 id="andar.path_builder" class="doc doc-heading">
            <code>andar.path_builder</code>


</h1>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="andar.path_builder.FieldConf" class="doc doc-heading">
            <code>FieldConf</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">



        <p>:param pattern: is used for validate input of get_path and get_parent_path, and also for getting fields using
                parse_path
:param date_format: date_format and datetime_format are using for a second validation using parse_path,
  for defining the how to cast the string (date or datetime, depending on the argument that was use)
  and for get_path and get_parent_path of accepting either a string or a datetime object that can be
  formated to input for a template string
:param datetime_format: See description of date_format parameter.
:param is_optional: allows to omit a field during the path generation (get_path and get_parent_path)
                    or to skip field during the path parsing. IMPORTANT! in order to work properly, pattern must
                    be constrained, otherwise the PathBuilder class may have an unexpected behaviour.
                    For example use '[0-9]{4}' and avoid using '*' or '+' when using is_optional=True</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>andar/path_builder.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FieldConf</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param pattern: is used for validate input of get_path and get_parent_path, and also for getting fields using</span>
<span class="sd">                    parse_path</span>
<span class="sd">    :param date_format: date_format and datetime_format are using for a second validation using parse_path,</span>
<span class="sd">      for defining the how to cast the string (date or datetime, depending on the argument that was use)</span>
<span class="sd">      and for get_path and get_parent_path of accepting either a string or a datetime object that can be</span>
<span class="sd">      formated to input for a template string</span>
<span class="sd">    :param datetime_format: See description of date_format parameter.</span>
<span class="sd">    :param is_optional: allows to omit a field during the path generation (get_path and get_parent_path)</span>
<span class="sd">                        or to skip field during the path parsing. IMPORTANT! in order to work properly, pattern must</span>
<span class="sd">                        be constrained, otherwise the PathBuilder class may have an unexpected behaviour.</span>
<span class="sd">                        For example use &#39;[0-9]{4}&#39; and avoid using &#39;*&#39; or &#39;+&#39; when using is_optional=True</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pattern</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">SafePatterns</span><span class="o">.</span><span class="n">FILENAME</span>
    <span class="n">date_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">datetime_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">str_to_var</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">var_to_str</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">has_date_converter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">has_datetime_converter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">has_custom_converter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_to_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_to_var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">active_converters_num</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">has_date_converter</span><span class="p">,</span> <span class="n">has_datetime_converter</span><span class="p">,</span> <span class="n">has_custom_converter</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">active_converters_num</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum one field converter is allowed, but </span><span class="si">{</span><span class="n">active_converters_num</span><span class="si">}</span><span class="s2"> were found&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a copy of the current object replacing attributes with the given keyword arguments</span>

<span class="sd">        :param kwargs: Attributes to be replaced</span>
<span class="sd">        :return: An FieldConf object with the attributes replaced</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">field_conf</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">field_conf</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.FieldConf.replace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">replace</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a copy of the current object replacing attributes with the given keyword arguments</p>
<p>:param kwargs: Attributes to be replaced
:return: An FieldConf object with the attributes replaced</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a copy of the current object replacing attributes with the given keyword arguments</span>

<span class="sd">    :param kwargs: Attributes to be replaced</span>
<span class="sd">    :return: An FieldConf object with the attributes replaced</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field_conf</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">field_conf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="andar.path_builder.PathBuilder" class="doc doc-heading">
            <code>PathBuilder</code>


</h2>


    <div class="doc doc-contents ">



        <p>Path Builder allows to define, create and parse templated paths</p>
<p>It defines a path via a path template and its fields. Once instantiated, it allows to create new paths
and to parse path strings to recover individual fields.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>andar/path_builder.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PathBuilder</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Path Builder allows to define, create and parse templated paths</span>

<span class="sd">    It defines a path via a path template and its fields. Once instantiated, it allows to create new paths</span>
<span class="sd">    and to parse path strings to recover individual fields.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">template</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FieldConf</span><span class="p">]</span>
    <span class="n">default_field</span><span class="p">:</span> <span class="n">FieldConf</span>
    <span class="n">parent_template</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">_dir_sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">parent_template</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FieldConf</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_field</span><span class="p">:</span> <span class="n">FieldConf</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="n">template</span>

        <span class="k">if</span> <span class="n">parent_template</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parent_template</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_parent_path_template</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">parent_template</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent_template</span> <span class="o">=</span> <span class="n">parent_template</span>

        <span class="k">if</span> <span class="n">default_field</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">default_field</span> <span class="o">=</span> <span class="n">FieldConf</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_field</span> <span class="o">=</span> <span class="n">default_field</span>

        <span class="n">new_fields</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">template_field_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_template_fields_names</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">template_field_names</span><span class="p">:</span>
            <span class="n">new_fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_field</span>

        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_fields</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">new_fields</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_template_fields</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">new_fields</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;Template: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="si">}</span><span class="s2">&#39;, Fields: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a copy of the current object replacing attributes with the given keyword arguments</span>

<span class="sd">        :param kwargs: Attributes to be replaced, same arguments as used for PathBuilder instantiation</span>
<span class="sd">        :return: A PathBuilder instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">default_parent_template</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;template&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;template&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span>
            <span class="n">default_parent_template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_template</span>
        <span class="k">if</span> <span class="s2">&quot;parent_template&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;parent_template&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_parent_template</span>
        <span class="k">if</span> <span class="s2">&quot;fields&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span>
        <span class="k">if</span> <span class="s2">&quot;default_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;default_field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_field</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a copy of the current object updating attributes with the given keyword arguments</span>
<span class="sd">        :param kwargs: Attributes to be updated, same arguments as used for PathBuilder instantiation.</span>
<span class="sd">                       Fields set to None, will be reset to default, if it is no longer present on the template, it will</span>
<span class="sd">                       be removed.</span>
<span class="sd">        :return: A PathBuilder instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;fields&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">fields</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">])</span>
            <span class="n">fields_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="p">[</span><span class="n">fields</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">fields_names</span> <span class="k">if</span> <span class="n">fields</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]</span>  <span class="c1"># remove fields set to None from input args</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_template_fields_names</span><span class="p">(</span><span class="n">path_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get fields names from path template string</span>

<span class="sd">        :param path_template: String. Path template that follows string.Formatter() syntax.</span>
<span class="sd">        :return: List. Template fields names.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed_field_tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">Formatter</span><span class="p">()</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">path_template</span><span class="p">))</span>
        <span class="n">template_fields_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">conv</span><span class="p">)</span> <span class="ow">in</span> <span class="n">parsed_field_tuples</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">template_fields_names</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_template_fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">map_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if fields in the path_template are coherent with keys in the given map_dict</span>

<span class="sd">        :param path_template: String. Path template that follows string.Formatter() syntax.</span>
<span class="sd">        :param map_dict: A dictionary where each key represent a field of the template and each value is string to be</span>
<span class="sd">                         mapped</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">template_fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_template_fields_names</span><span class="p">(</span><span class="n">path_template</span><span class="p">)</span>
        <span class="n">invalid_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">map_dict</span> <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">template_fields</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">invalid_fields</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid fields: </span><span class="si">{</span><span class="n">invalid_fields</span><span class="si">}</span><span class="s2"> they do not exist on path_template: &#39;</span><span class="si">{</span><span class="n">path_template</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="n">missing_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">template_fields</span> <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">map_dict</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">missing_fields</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing fields: </span><span class="si">{</span><span class="n">missing_fields</span><span class="si">}</span><span class="s2"> they are required in path_template: &#39;</span><span class="si">{</span><span class="n">path_template</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">assign_groupname_pattern_dict</span><span class="p">(</span><span class="n">pattern_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assign a group name to each regex pattern present in the given dictionary</span>

<span class="sd">        :param pattern_dict: A dictionary of regex patterns, where each key will be used as group name. It does not</span>
<span class="sd">                             check if the pattern already have a group name assign.</span>
<span class="sd">        :return: A dictionary where the patterns have been assigned a group name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">named_pattern_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">pattern_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">named_pattern_dict</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(?P&lt;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="n">named_pattern_dict</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parse_fields</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">pattern_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">raise_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse a string using a template and a patterns dictionary</span>

<span class="sd">        Example:</span>
<span class="sd">        filename_template = &quot;{prefix}_{name}.{extension}&quot;</span>
<span class="sd">        pattern_dict = {&quot;prefix&quot;: &quot;[0-9]{4}&quot;, &quot;name&quot;: &quot;[a-zA-Z0-9]+&quot;, &quot;extension&quot;: &quot;json&quot;}</span>
<span class="sd">        filename = &quot;0001_example.json&quot;</span>
<span class="sd">        parsed_filename_dict = parse_fields(filename, filename_template, pattern_dict)</span>
<span class="sd">        invalid_filename = &quot;invalid_example.json&quot;</span>
<span class="sd">        parse_fields(invalid_filename, filename_template, pattern_dict, raise_error=True)</span>

<span class="sd">        :param _string: String to be parsed.</span>
<span class="sd">        :param template: A template that follows string.Formatter() syntax.</span>
<span class="sd">        :param pattern_dict: A dictionary where each key represent a field of the template and each value is the</span>
<span class="sd">                             corresponding regex pattern</span>
<span class="sd">        :param raise_error: Raise an exception if the path is not valid. If False, it returns None.</span>
<span class="sd">        :return: A dictionary of parsed fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">check_template_fields</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">pattern_dict</span><span class="p">)</span>
        <span class="n">template_fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_template_fields_names</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>

        <span class="c1"># Deduplicate repeated fields of pattern_dict:</span>
        <span class="c1"># for example the template &quot;/{base_path}/{asset_name}/{asset_name}_{suffix}&quot;</span>
        <span class="c1"># will become &quot;/{base_path}/{asset_name__0}/{asset_name__1}_{suffix}&quot;</span>
        <span class="c1"># and the dict {&quot;base_path&quot;: r&quot;\w+&quot;, &quot;asset_name&quot;: r&quot;\w+&quot;, &quot;suffix&quot;: r&quot;\d+&quot;}</span>
        <span class="c1"># will become {&quot;base_path&quot;: r&quot;\w+&quot;, &quot;asset_name__0&quot;: r&quot;\w+&quot;, &quot;asset_name__1&quot;: r&quot;\w+&quot;, &quot;suffix&quot;: r&quot;\d+&quot;}</span>
        <span class="n">unique_fields</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">template_fields</span><span class="p">))</span>
        <span class="n">deduplicated_fields_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">new_pattern_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">new_template</span> <span class="o">=</span> <span class="n">template</span>
        <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">unique_fields</span><span class="p">:</span>
            <span class="n">field_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">template_fields</span> <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="n">field_name</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">field_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">new_pattern_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
                <span class="k">continue</span>
            <span class="n">deduplicated_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">field_count</span><span class="p">):</span>
                <span class="n">new_field_name</span> <span class="o">=</span> <span class="n">field_name</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;__</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">deduplicated_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_field_name</span><span class="p">)</span>
                <span class="n">new_pattern_dict</span><span class="p">[</span><span class="n">new_field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
                <span class="n">new_template</span> <span class="o">=</span> <span class="n">new_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">field_name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">new_field_name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">deduplicated_fields_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">deduplicated_list</span>

        <span class="n">has_duplicates</span> <span class="o">=</span> <span class="n">pattern_dict</span> <span class="o">!=</span> <span class="n">new_pattern_dict</span>
        <span class="k">if</span> <span class="n">has_duplicates</span><span class="p">:</span>
            <span class="n">pattern_dict</span> <span class="o">=</span> <span class="n">new_pattern_dict</span>
            <span class="n">template</span> <span class="o">=</span> <span class="n">new_template</span>

        <span class="c1"># Build full pattern string</span>
        <span class="n">named_pattern_dict</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">assign_groupname_pattern_dict</span><span class="p">(</span><span class="n">pattern_dict</span><span class="p">)</span>
        <span class="n">path_pattern</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">named_pattern_dict</span><span class="p">)</span>
        <span class="n">path_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;^</span><span class="si">{</span><span class="n">path_pattern</span><span class="si">}</span><span class="s2">$&quot;</span>  <span class="c1"># match the full string</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">path_pattern</span><span class="p">,</span> <span class="n">_string</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">raise_error</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid string &#39;</span><span class="si">{</span><span class="n">_string</span><span class="si">}</span><span class="s2">&#39;, expected pattern: &#39;</span><span class="si">{</span><span class="n">path_pattern</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">parsed_fields_dict</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>

        <span class="c1"># Fusion deduplicated fields:</span>
        <span class="c1"># it will raise an error if the deduplicate fields have multiples values</span>
        <span class="c1"># for example this parsed dict will raise an error because asset_name__0 and asset_name__1 should be equal:</span>
        <span class="c1"># {&quot;base_path&quot;: &quot;folder&quot;, &quot;asset_name__0&quot;: &quot;my_asset&quot;, &quot;asset_name__1&quot;: &quot;other_asset&quot;, &quot;suffix&quot;: &quot;001&quot;}</span>
        <span class="c1"># if the deduplicated fields are coherent they will be fusion and renamed to its original name:</span>
        <span class="c1"># for example {&quot;base_path&quot;: &quot;folder&quot;, &quot;asset_name__0&quot;: &quot;my_asset&quot;, &quot;asset_name__1&quot;: &quot;my_asset&quot;, &quot;suffix&quot;: &quot;001&quot;}</span>
        <span class="c1"># to {&quot;base_path&quot;: &quot;folder&quot;, &quot;asset_name&quot;: &quot;my_asset&quot;, &quot;suffix&quot;: &quot;001&quot;}</span>
        <span class="k">for</span> <span class="n">original_field_name</span><span class="p">,</span> <span class="n">deduplicated_list</span> <span class="ow">in</span> <span class="n">deduplicated_fields_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">parsed_field_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">parsed_fields_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">deduplicated_list</span><span class="p">]</span>
            <span class="n">unique_parsed_field_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">parsed_field_values</span><span class="p">))</span>
            <span class="n">are_duplicated_unique</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_parsed_field_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">are_duplicated_unique</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;More than one value was found for repeated field &#39;</span><span class="si">{</span><span class="n">original_field_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">parsed_field_values</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">parsed_fields_dict</span><span class="p">[</span><span class="n">original_field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">unique_parsed_field_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">parsed_fields_dict</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_file_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">raise_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse a file path</span>

<span class="sd">        :param file_path: String to be parsed.</span>
<span class="sd">        :param raise_error: Whether to raise an exception if the file path is not valid. By default, it returns None.</span>
<span class="sd">        :return: Dictionary where each key represent a field of the template and each value is the corresponding parsed</span>
<span class="sd">                 string (or converted object)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir_sep</span>
        <span class="n">path_template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span>
        <span class="n">path_template</span> <span class="o">=</span> <span class="n">path_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\.&quot;</span><span class="p">)</span>
        <span class="n">pattern_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_conf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">field_pattern</span> <span class="o">=</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span>
            <span class="k">if</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">is_optional</span><span class="p">:</span>
                <span class="n">field_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field_pattern</span><span class="si">}</span><span class="s2">|&quot;</span>
                <span class="c1"># Allow optional directory separator for this field: &quot;/&quot; -&gt; &quot;/?&quot;, by updating path_template</span>
                <span class="n">field_name_dir_sep</span> <span class="o">=</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">field_name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span> <span class="o">+</span> <span class="n">ds</span> <span class="o">+</span> <span class="s2">&quot;{&quot;</span>
                <span class="n">optional_field_name_dir_sep</span> <span class="o">=</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">field_name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span> <span class="o">+</span> <span class="n">ds</span> <span class="o">+</span> <span class="s2">&quot;?{&quot;</span>
                <span class="n">path_template</span> <span class="o">=</span> <span class="n">path_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">field_name_dir_sep</span><span class="p">,</span> <span class="n">optional_field_name_dir_sep</span><span class="p">)</span>
            <span class="n">pattern_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_pattern</span>
        <span class="n">parsed_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_fields</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">path_template</span><span class="p">,</span> <span class="n">pattern_dict</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="n">raise_error</span><span class="p">)</span>
        <span class="n">processed_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_parsed_fields_values</span><span class="p">(</span><span class="n">parsed_fields</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">processed_fields</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_parent_path_template</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parent_path_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if parent_path_template is coherent with path_template</span>

<span class="sd">        :param path_template: String. Path template that follows string.Formatter() syntax.</span>
<span class="sd">        :param parent_path_template: String. Parent path template that follows string.Formatter() syntax.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">parent_path_template</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">path_template</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;path_template: &#39;</span><span class="si">{</span><span class="n">path_template</span><span class="si">}</span><span class="s2">&#39; does not match with parent_path_template: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">parent_path_template</span><span class="si">}</span><span class="s2">&#39;. parent_path_template must be a substring of path_template&quot;</span>
            <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_fields_values</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">fields_values_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="n">Any</span><span class="p">],</span> <span class="n">fields_conf</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FieldConf</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare fields values for this path</span>
<span class="sd">        :param fields_values_dict: Dictionary of fields values</span>
<span class="sd">        :param fields_conf: Dictionary of fields configuration (i.e.class FieldConf)</span>
<span class="sd">        :return: A dictionary of fields where the values were converted to strings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_fields_values_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_value</span> <span class="ow">in</span> <span class="n">fields_values_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields_conf</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;skipping field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">field_conf</span> <span class="o">=</span> <span class="n">fields_conf</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">field_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">is_optional</span><span class="p">:</span>
                <span class="n">new_fields_values_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">date_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">field_value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">field_conf</span><span class="o">.</span><span class="n">date_format</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">datetime_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">field_value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">field_conf</span><span class="o">.</span><span class="n">datetime_format</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">var_to_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">var_to_str</span><span class="p">(</span><span class="n">field_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_field_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">field_value</span><span class="p">)</span>

            <span class="n">field_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;^</span><span class="si">{</span><span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span><span class="si">}</span><span class="s2">$&quot;</span>  <span class="c1"># Exact pattern</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">field_pattern</span><span class="p">,</span> <span class="n">new_field_value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39; value: &#39;</span><span class="si">{</span><span class="n">new_field_value</span><span class="si">}</span><span class="s2">&#39;. It does not match pattern: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                <span class="p">)</span>
            <span class="n">new_fields_values_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_field_value</span>
        <span class="k">return</span> <span class="n">new_fields_values_dict</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_parsed_fields_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_fields</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process fields values dictionary obtained from parsing a file path</span>
<span class="sd">        :param parsed_fields: A dictionary of parsed fields values in string format.</span>
<span class="sd">        :return: A processed dictionary of fields with converted values depending on each FieldConf definition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_parsed_fields</span> <span class="o">=</span> <span class="n">parsed_fields</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_value</span> <span class="ow">in</span> <span class="n">new_parsed_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39;. Valid fields are: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">field_conf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>

            <span class="n">field_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;^</span><span class="si">{</span><span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span><span class="si">}</span><span class="s2">$&quot;</span>  <span class="c1"># Exact pattern</span>
            <span class="k">if</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">is_optional</span><span class="p">:</span>
                <span class="n">field_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;^</span><span class="si">{</span><span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span><span class="si">}</span><span class="s2">|$&quot;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">field_pattern</span><span class="p">,</span> <span class="n">field_value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39; value: &#39;</span><span class="si">{</span><span class="n">field_value</span><span class="si">}</span><span class="s2">&#39;. It does not match pattern: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">date_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">date_format</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">datetime_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">datetime_format</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">str_to_var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">str_to_var</span><span class="p">(</span><span class="n">field_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_field_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">field_value</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">new_field_value</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">is_optional</span><span class="p">:</span>
                <span class="n">new_field_value</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">new_parsed_fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_field_value</span>
        <span class="k">return</span> <span class="n">new_parsed_fields</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_path</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">fields_conf</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FieldConf</span><span class="p">],</span>
        <span class="n">fields_values_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate path using input parameters</span>

<span class="sd">        :param template: A template that follows string.Formatter() syntax.</span>
<span class="sd">        :param fields_conf: Dictionary of fields configurations, where keys are field names and values are FieldConf</span>
<span class="sd">                            instances.</span>
<span class="sd">        :param fields_values_dict: Input parameters dict that maps template fields to values.</span>
<span class="sd">        :return: String. Path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fields_values_dict</span> <span class="o">=</span> <span class="n">fields_values_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">template_fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_template_fields_names</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
        <span class="n">missing_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">template_fields</span> <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields_values_dict</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">missing_fields</span><span class="p">:</span>
            <span class="n">is_optional</span> <span class="o">=</span> <span class="n">fields_conf</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">is_optional</span>
            <span class="k">if</span> <span class="n">is_optional</span><span class="p">:</span>
                <span class="n">fields_values_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">cls</span><span class="o">.</span><span class="n">check_template_fields</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">fields_values_dict</span><span class="p">)</span>
        <span class="n">fields_values_dict</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">prepare_fields_values</span><span class="p">(</span><span class="n">fields_values_dict</span><span class="p">,</span> <span class="n">fields_conf</span><span class="p">)</span>
        <span class="n">new_path</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">fields_values_dict</span><span class="p">)</span>
        <span class="n">new_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">new_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate path using input parameters</span>

<span class="sd">        :param kwargs: Input parameters that maps template fields to values.</span>
<span class="sd">        :return: String. Path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_path</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">,</span> <span class="n">fields_conf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span> <span class="n">fields_values_dict</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_parent_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate parent path using input parameters</span>

<span class="sd">        :param kwargs: Input parameters that maps template fields to values. They are used in the order of</span>
<span class="sd">                       parent_template, if the last argument(s) are omitted, the parent_template will be dynamically</span>
<span class="sd">                       updated to a shorter version. If an argument in the middle is omitted, and it is not optional,</span>
<span class="sd">                       an error will be raised.</span>
<span class="sd">        :return: String. Parent path.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># remove all fields not present in parent template</span>
        <span class="n">parent_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">fields_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_template_fields_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>
        <span class="n">parent_fields_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_template_fields_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent_template</span><span class="p">)</span>

        <span class="c1"># Drop fields corresponding to filename</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parent_fields_names</span><span class="p">:</span>
                <span class="n">parent_fields</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

        <span class="c1"># Make dynamic the parent path creation, so the last fields can be omitted</span>
        <span class="c1"># for example &quot;{a}/{b}/{c}/{d}/&quot; or &quot;{a}/{b}/{c}/&quot; or &quot;{a}/{b}/&quot;</span>
        <span class="n">new_parent_template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_template</span>
        <span class="n">dynamic_fields_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">missing_kwarg_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">parent_field_name</span> <span class="ow">in</span> <span class="n">parent_fields_names</span><span class="p">:</span>
            <span class="n">is_optional</span> <span class="o">=</span> <span class="n">parent_fields</span><span class="p">[</span><span class="n">parent_field_name</span><span class="p">]</span><span class="o">.</span><span class="n">is_optional</span>
            <span class="k">if</span> <span class="n">parent_field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_optional</span><span class="p">:</span>
                <span class="c1"># keep known (left) part of parent_template and drop the rest</span>
                <span class="n">missing_kwarg_name</span> <span class="o">=</span> <span class="n">parent_field_name</span>
                <span class="n">new_parent_template</span> <span class="o">=</span> <span class="n">new_parent_template</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">parent_field_name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">break</span>
            <span class="n">dynamic_fields_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent_field_name</span><span class="p">)</span>

        <span class="c1"># Drop fields corresponding to last arguments that were skipped</span>
        <span class="n">parent_fields_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">parent_fields</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">parent_fields_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dynamic_fields_names</span><span class="p">:</span>
                <span class="n">parent_fields</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span>

        <span class="c1"># Check for unnecessary extra args</span>
        <span class="n">extra_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parent_fields</span><span class="p">:</span>
                <span class="n">extra_kwargs</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">missing_kwarg_name</span> <span class="ow">and</span> <span class="n">extra_kwargs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected extra kwargs: </span><span class="si">{</span><span class="n">extra_kwargs</span><span class="si">}</span><span class="s2">, after updating parent template &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;to &#39;</span><span class="si">{</span><span class="n">new_parent_template</span><span class="si">}</span><span class="s2">&#39; because of missing kwarg: &#39;</span><span class="si">{</span><span class="n">missing_kwarg_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_path</span><span class="p">(</span>
            <span class="n">template</span><span class="o">=</span><span class="n">new_parent_template</span><span class="p">,</span>
            <span class="n">fields_conf</span><span class="o">=</span><span class="n">parent_fields</span><span class="p">,</span>
            <span class="n">fields_values_dict</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">assert_path_bijection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assert path bijection</span>

<span class="sd">        It tries to recover the same initial input after processing once with parse_file_path and get_path</span>

<span class="sd">        :param test_path: Path string to be tested</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_file_path</span><span class="p">(</span><span class="n">test_path</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">result_test_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="o">**</span><span class="n">parsed_fields</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">test_path</span> <span class="o">==</span> <span class="n">result_test_path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">test_path</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">result_test_path</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">assert_fields_bijection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_fields</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assert fields bijection</span>

<span class="sd">        It tries to recover the same initial input after processing once with get_path and parse_file_path</span>
<span class="sd">        This method is the preferred way of checking if the PathBuilder was well-defined.</span>

<span class="sd">        :param test_fields: Dictionary of fields to be tested</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">test_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="o">**</span><span class="n">test_fields</span><span class="p">)</span>
        <span class="n">result_parsed_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_file_path</span><span class="p">(</span><span class="n">test_path</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">test_fields</span> <span class="o">==</span> <span class="n">result_parsed_fields</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">test_fields</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">result_parsed_fields</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.assert_fields_bijection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assert_fields_bijection</span><span class="p">(</span><span class="n">test_fields</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assert fields bijection</p>
<p>It tries to recover the same initial input after processing once with get_path and parse_file_path
This method is the preferred way of checking if the PathBuilder was well-defined.</p>
<p>:param test_fields: Dictionary of fields to be tested</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">assert_fields_bijection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_fields</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assert fields bijection</span>

<span class="sd">    It tries to recover the same initial input after processing once with get_path and parse_file_path</span>
<span class="sd">    This method is the preferred way of checking if the PathBuilder was well-defined.</span>

<span class="sd">    :param test_fields: Dictionary of fields to be tested</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">test_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="o">**</span><span class="n">test_fields</span><span class="p">)</span>
    <span class="n">result_parsed_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_file_path</span><span class="p">(</span><span class="n">test_path</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">test_fields</span> <span class="o">==</span> <span class="n">result_parsed_fields</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">test_fields</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">result_parsed_fields</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.assert_path_bijection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assert_path_bijection</span><span class="p">(</span><span class="n">test_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assert path bijection</p>
<p>It tries to recover the same initial input after processing once with parse_file_path and get_path</p>
<p>:param test_path: Path string to be tested</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">assert_path_bijection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assert path bijection</span>

<span class="sd">    It tries to recover the same initial input after processing once with parse_file_path and get_path</span>

<span class="sd">    :param test_path: Path string to be tested</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parsed_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_file_path</span><span class="p">(</span><span class="n">test_path</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">result_test_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="o">**</span><span class="n">parsed_fields</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">test_path</span> <span class="o">==</span> <span class="n">result_test_path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">test_path</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">result_test_path</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.assign_groupname_pattern_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_groupname_pattern_dict</span><span class="p">(</span><span class="n">pattern_dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Assign a group name to each regex pattern present in the given dictionary</p>
<p>:param pattern_dict: A dictionary of regex patterns, where each key will be used as group name. It does not
                     check if the pattern already have a group name assign.
:return: A dictionary where the patterns have been assigned a group name.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">assign_groupname_pattern_dict</span><span class="p">(</span><span class="n">pattern_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assign a group name to each regex pattern present in the given dictionary</span>

<span class="sd">    :param pattern_dict: A dictionary of regex patterns, where each key will be used as group name. It does not</span>
<span class="sd">                         check if the pattern already have a group name assign.</span>
<span class="sd">    :return: A dictionary where the patterns have been assigned a group name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">named_pattern_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">pattern_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">named_pattern_dict</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(?P&lt;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">return</span> <span class="n">named_pattern_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.check_parent_path_template" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_parent_path_template</span><span class="p">(</span><span class="n">path_template</span><span class="p">,</span> <span class="n">parent_path_template</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if parent_path_template is coherent with path_template</p>
<p>:param path_template: String. Path template that follows string.Formatter() syntax.
:param parent_path_template: String. Parent path template that follows string.Formatter() syntax.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_parent_path_template</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parent_path_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if parent_path_template is coherent with path_template</span>

<span class="sd">    :param path_template: String. Path template that follows string.Formatter() syntax.</span>
<span class="sd">    :param parent_path_template: String. Parent path template that follows string.Formatter() syntax.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">parent_path_template</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">path_template</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;path_template: &#39;</span><span class="si">{</span><span class="n">path_template</span><span class="si">}</span><span class="s2">&#39; does not match with parent_path_template: &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">parent_path_template</span><span class="si">}</span><span class="s2">&#39;. parent_path_template must be a substring of path_template&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.check_template_fields" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_template_fields</span><span class="p">(</span><span class="n">path_template</span><span class="p">,</span> <span class="n">map_dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Check if fields in the path_template are coherent with keys in the given map_dict</p>
<p>:param path_template: String. Path template that follows string.Formatter() syntax.
:param map_dict: A dictionary where each key represent a field of the template and each value is string to be
                 mapped</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_template_fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">map_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if fields in the path_template are coherent with keys in the given map_dict</span>

<span class="sd">    :param path_template: String. Path template that follows string.Formatter() syntax.</span>
<span class="sd">    :param map_dict: A dictionary where each key represent a field of the template and each value is string to be</span>
<span class="sd">                     mapped</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">template_fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_template_fields_names</span><span class="p">(</span><span class="n">path_template</span><span class="p">)</span>
    <span class="n">invalid_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">map_dict</span> <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">template_fields</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">invalid_fields</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid fields: </span><span class="si">{</span><span class="n">invalid_fields</span><span class="si">}</span><span class="s2"> they do not exist on path_template: &#39;</span><span class="si">{</span><span class="n">path_template</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="n">missing_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">template_fields</span> <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">map_dict</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">missing_fields</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing fields: </span><span class="si">{</span><span class="n">missing_fields</span><span class="si">}</span><span class="s2"> they are required in path_template: &#39;</span><span class="si">{</span><span class="n">path_template</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.get_parent_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_parent_path</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate parent path using input parameters</p>
<p>:param kwargs: Input parameters that maps template fields to values. They are used in the order of
               parent_template, if the last argument(s) are omitted, the parent_template will be dynamically
               updated to a shorter version. If an argument in the middle is omitted, and it is not optional,
               an error will be raised.
:return: String. Parent path.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_parent_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate parent path using input parameters</span>

<span class="sd">    :param kwargs: Input parameters that maps template fields to values. They are used in the order of</span>
<span class="sd">                   parent_template, if the last argument(s) are omitted, the parent_template will be dynamically</span>
<span class="sd">                   updated to a shorter version. If an argument in the middle is omitted, and it is not optional,</span>
<span class="sd">                   an error will be raised.</span>
<span class="sd">    :return: String. Parent path.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># remove all fields not present in parent template</span>
    <span class="n">parent_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">fields_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_template_fields_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>
    <span class="n">parent_fields_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_template_fields_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent_template</span><span class="p">)</span>

    <span class="c1"># Drop fields corresponding to filename</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parent_fields_names</span><span class="p">:</span>
            <span class="n">parent_fields</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

    <span class="c1"># Make dynamic the parent path creation, so the last fields can be omitted</span>
    <span class="c1"># for example &quot;{a}/{b}/{c}/{d}/&quot; or &quot;{a}/{b}/{c}/&quot; or &quot;{a}/{b}/&quot;</span>
    <span class="n">new_parent_template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_template</span>
    <span class="n">dynamic_fields_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">missing_kwarg_name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">parent_field_name</span> <span class="ow">in</span> <span class="n">parent_fields_names</span><span class="p">:</span>
        <span class="n">is_optional</span> <span class="o">=</span> <span class="n">parent_fields</span><span class="p">[</span><span class="n">parent_field_name</span><span class="p">]</span><span class="o">.</span><span class="n">is_optional</span>
        <span class="k">if</span> <span class="n">parent_field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_optional</span><span class="p">:</span>
            <span class="c1"># keep known (left) part of parent_template and drop the rest</span>
            <span class="n">missing_kwarg_name</span> <span class="o">=</span> <span class="n">parent_field_name</span>
            <span class="n">new_parent_template</span> <span class="o">=</span> <span class="n">new_parent_template</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">parent_field_name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">break</span>
        <span class="n">dynamic_fields_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent_field_name</span><span class="p">)</span>

    <span class="c1"># Drop fields corresponding to last arguments that were skipped</span>
    <span class="n">parent_fields_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">parent_fields</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">parent_fields_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dynamic_fields_names</span><span class="p">:</span>
            <span class="n">parent_fields</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span>

    <span class="c1"># Check for unnecessary extra args</span>
    <span class="n">extra_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parent_fields</span><span class="p">:</span>
            <span class="n">extra_kwargs</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">missing_kwarg_name</span> <span class="ow">and</span> <span class="n">extra_kwargs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unexpected extra kwargs: </span><span class="si">{</span><span class="n">extra_kwargs</span><span class="si">}</span><span class="s2">, after updating parent template &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;to &#39;</span><span class="si">{</span><span class="n">new_parent_template</span><span class="si">}</span><span class="s2">&#39; because of missing kwarg: &#39;</span><span class="si">{</span><span class="n">missing_kwarg_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_path</span><span class="p">(</span>
        <span class="n">template</span><span class="o">=</span><span class="n">new_parent_template</span><span class="p">,</span>
        <span class="n">fields_conf</span><span class="o">=</span><span class="n">parent_fields</span><span class="p">,</span>
        <span class="n">fields_values_dict</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.get_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_path</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate path using input parameters</p>
<p>:param kwargs: Input parameters that maps template fields to values.
:return: String. Path.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate path using input parameters</span>

<span class="sd">    :param kwargs: Input parameters that maps template fields to values.</span>
<span class="sd">    :return: String. Path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_path</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">,</span> <span class="n">fields_conf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span> <span class="n">fields_values_dict</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.get_template_fields_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_template_fields_names</span><span class="p">(</span><span class="n">path_template</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get fields names from path template string</p>
<p>:param path_template: String. Path template that follows string.Formatter() syntax.
:return: List. Template fields names.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_template_fields_names</span><span class="p">(</span><span class="n">path_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get fields names from path template string</span>

<span class="sd">    :param path_template: String. Path template that follows string.Formatter() syntax.</span>
<span class="sd">    :return: List. Template fields names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parsed_field_tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">Formatter</span><span class="p">()</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">path_template</span><span class="p">))</span>
    <span class="n">template_fields_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">conv</span><span class="p">)</span> <span class="ow">in</span> <span class="n">parsed_field_tuples</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">template_fields_names</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.parse_fields" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_fields</span><span class="p">(</span><span class="n">_string</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">pattern_dict</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Parse a string using a template and a patterns dictionary</p>
<p>Example:
filename_template = "{prefix}_{name}.{extension}"
pattern_dict = {"prefix": "[0-9]{4}", "name": "[a-zA-Z0-9]+", "extension": "json"}
filename = "0001_example.json"
parsed_filename_dict = parse_fields(filename, filename_template, pattern_dict)
invalid_filename = "invalid_example.json"
parse_fields(invalid_filename, filename_template, pattern_dict, raise_error=True)</p>
<p>:param _string: String to be parsed.
:param template: A template that follows string.Formatter() syntax.
:param pattern_dict: A dictionary where each key represent a field of the template and each value is the
                     corresponding regex pattern
:param raise_error: Raise an exception if the path is not valid. If False, it returns None.
:return: A dictionary of parsed fields.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">parse_fields</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pattern_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">raise_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse a string using a template and a patterns dictionary</span>

<span class="sd">    Example:</span>
<span class="sd">    filename_template = &quot;{prefix}_{name}.{extension}&quot;</span>
<span class="sd">    pattern_dict = {&quot;prefix&quot;: &quot;[0-9]{4}&quot;, &quot;name&quot;: &quot;[a-zA-Z0-9]+&quot;, &quot;extension&quot;: &quot;json&quot;}</span>
<span class="sd">    filename = &quot;0001_example.json&quot;</span>
<span class="sd">    parsed_filename_dict = parse_fields(filename, filename_template, pattern_dict)</span>
<span class="sd">    invalid_filename = &quot;invalid_example.json&quot;</span>
<span class="sd">    parse_fields(invalid_filename, filename_template, pattern_dict, raise_error=True)</span>

<span class="sd">    :param _string: String to be parsed.</span>
<span class="sd">    :param template: A template that follows string.Formatter() syntax.</span>
<span class="sd">    :param pattern_dict: A dictionary where each key represent a field of the template and each value is the</span>
<span class="sd">                         corresponding regex pattern</span>
<span class="sd">    :param raise_error: Raise an exception if the path is not valid. If False, it returns None.</span>
<span class="sd">    :return: A dictionary of parsed fields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">check_template_fields</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">pattern_dict</span><span class="p">)</span>
    <span class="n">template_fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_template_fields_names</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>

    <span class="c1"># Deduplicate repeated fields of pattern_dict:</span>
    <span class="c1"># for example the template &quot;/{base_path}/{asset_name}/{asset_name}_{suffix}&quot;</span>
    <span class="c1"># will become &quot;/{base_path}/{asset_name__0}/{asset_name__1}_{suffix}&quot;</span>
    <span class="c1"># and the dict {&quot;base_path&quot;: r&quot;\w+&quot;, &quot;asset_name&quot;: r&quot;\w+&quot;, &quot;suffix&quot;: r&quot;\d+&quot;}</span>
    <span class="c1"># will become {&quot;base_path&quot;: r&quot;\w+&quot;, &quot;asset_name__0&quot;: r&quot;\w+&quot;, &quot;asset_name__1&quot;: r&quot;\w+&quot;, &quot;suffix&quot;: r&quot;\d+&quot;}</span>
    <span class="n">unique_fields</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">template_fields</span><span class="p">))</span>
    <span class="n">deduplicated_fields_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">new_pattern_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">new_template</span> <span class="o">=</span> <span class="n">template</span>
    <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">unique_fields</span><span class="p">:</span>
        <span class="n">field_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">template_fields</span> <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="n">field_name</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">field_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">new_pattern_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
            <span class="k">continue</span>
        <span class="n">deduplicated_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">field_count</span><span class="p">):</span>
            <span class="n">new_field_name</span> <span class="o">=</span> <span class="n">field_name</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;__</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">deduplicated_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_field_name</span><span class="p">)</span>
            <span class="n">new_pattern_dict</span><span class="p">[</span><span class="n">new_field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
            <span class="n">new_template</span> <span class="o">=</span> <span class="n">new_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">field_name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">new_field_name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">deduplicated_fields_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">deduplicated_list</span>

    <span class="n">has_duplicates</span> <span class="o">=</span> <span class="n">pattern_dict</span> <span class="o">!=</span> <span class="n">new_pattern_dict</span>
    <span class="k">if</span> <span class="n">has_duplicates</span><span class="p">:</span>
        <span class="n">pattern_dict</span> <span class="o">=</span> <span class="n">new_pattern_dict</span>
        <span class="n">template</span> <span class="o">=</span> <span class="n">new_template</span>

    <span class="c1"># Build full pattern string</span>
    <span class="n">named_pattern_dict</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">assign_groupname_pattern_dict</span><span class="p">(</span><span class="n">pattern_dict</span><span class="p">)</span>
    <span class="n">path_pattern</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">named_pattern_dict</span><span class="p">)</span>
    <span class="n">path_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;^</span><span class="si">{</span><span class="n">path_pattern</span><span class="si">}</span><span class="s2">$&quot;</span>  <span class="c1"># match the full string</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">path_pattern</span><span class="p">,</span> <span class="n">_string</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">raise_error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid string &#39;</span><span class="si">{</span><span class="n">_string</span><span class="si">}</span><span class="s2">&#39;, expected pattern: &#39;</span><span class="si">{</span><span class="n">path_pattern</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">parsed_fields_dict</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>

    <span class="c1"># Fusion deduplicated fields:</span>
    <span class="c1"># it will raise an error if the deduplicate fields have multiples values</span>
    <span class="c1"># for example this parsed dict will raise an error because asset_name__0 and asset_name__1 should be equal:</span>
    <span class="c1"># {&quot;base_path&quot;: &quot;folder&quot;, &quot;asset_name__0&quot;: &quot;my_asset&quot;, &quot;asset_name__1&quot;: &quot;other_asset&quot;, &quot;suffix&quot;: &quot;001&quot;}</span>
    <span class="c1"># if the deduplicated fields are coherent they will be fusion and renamed to its original name:</span>
    <span class="c1"># for example {&quot;base_path&quot;: &quot;folder&quot;, &quot;asset_name__0&quot;: &quot;my_asset&quot;, &quot;asset_name__1&quot;: &quot;my_asset&quot;, &quot;suffix&quot;: &quot;001&quot;}</span>
    <span class="c1"># to {&quot;base_path&quot;: &quot;folder&quot;, &quot;asset_name&quot;: &quot;my_asset&quot;, &quot;suffix&quot;: &quot;001&quot;}</span>
    <span class="k">for</span> <span class="n">original_field_name</span><span class="p">,</span> <span class="n">deduplicated_list</span> <span class="ow">in</span> <span class="n">deduplicated_fields_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">parsed_field_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">parsed_fields_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">deduplicated_list</span><span class="p">]</span>
        <span class="n">unique_parsed_field_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">parsed_field_values</span><span class="p">))</span>
        <span class="n">are_duplicated_unique</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_parsed_field_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">are_duplicated_unique</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;More than one value was found for repeated field &#39;</span><span class="si">{</span><span class="n">original_field_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">parsed_field_values</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">parsed_fields_dict</span><span class="p">[</span><span class="n">original_field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">unique_parsed_field_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">parsed_fields_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.parse_file_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_file_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse a file path</p>
<p>:param file_path: String to be parsed.
:param raise_error: Whether to raise an exception if the file path is not valid. By default, it returns None.
:return: Dictionary where each key represent a field of the template and each value is the corresponding parsed
         string (or converted object)</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_file_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">raise_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse a file path</span>

<span class="sd">    :param file_path: String to be parsed.</span>
<span class="sd">    :param raise_error: Whether to raise an exception if the file path is not valid. By default, it returns None.</span>
<span class="sd">    :return: Dictionary where each key represent a field of the template and each value is the corresponding parsed</span>
<span class="sd">             string (or converted object)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir_sep</span>
    <span class="n">path_template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span>
    <span class="n">path_template</span> <span class="o">=</span> <span class="n">path_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\.&quot;</span><span class="p">)</span>
    <span class="n">pattern_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_conf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">field_pattern</span> <span class="o">=</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span>
        <span class="k">if</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">is_optional</span><span class="p">:</span>
            <span class="n">field_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field_pattern</span><span class="si">}</span><span class="s2">|&quot;</span>
            <span class="c1"># Allow optional directory separator for this field: &quot;/&quot; -&gt; &quot;/?&quot;, by updating path_template</span>
            <span class="n">field_name_dir_sep</span> <span class="o">=</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">field_name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span> <span class="o">+</span> <span class="n">ds</span> <span class="o">+</span> <span class="s2">&quot;{&quot;</span>
            <span class="n">optional_field_name_dir_sep</span> <span class="o">=</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">field_name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span> <span class="o">+</span> <span class="n">ds</span> <span class="o">+</span> <span class="s2">&quot;?{&quot;</span>
            <span class="n">path_template</span> <span class="o">=</span> <span class="n">path_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">field_name_dir_sep</span><span class="p">,</span> <span class="n">optional_field_name_dir_sep</span><span class="p">)</span>
        <span class="n">pattern_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_pattern</span>
    <span class="n">parsed_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_fields</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">path_template</span><span class="p">,</span> <span class="n">pattern_dict</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="n">raise_error</span><span class="p">)</span>
    <span class="n">processed_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_parsed_fields_values</span><span class="p">(</span><span class="n">parsed_fields</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">processed_fields</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.prepare_fields_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_fields_values</span><span class="p">(</span><span class="n">fields_values_dict</span><span class="p">,</span> <span class="n">fields_conf</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prepare fields values for this path
:param fields_values_dict: Dictionary of fields values
:param fields_conf: Dictionary of fields configuration (i.e.class FieldConf)
:return: A dictionary of fields where the values were converted to strings.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">prepare_fields_values</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">fields_values_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="n">Any</span><span class="p">],</span> <span class="n">fields_conf</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FieldConf</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prepare fields values for this path</span>
<span class="sd">    :param fields_values_dict: Dictionary of fields values</span>
<span class="sd">    :param fields_conf: Dictionary of fields configuration (i.e.class FieldConf)</span>
<span class="sd">    :return: A dictionary of fields where the values were converted to strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_fields_values_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_value</span> <span class="ow">in</span> <span class="n">fields_values_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields_conf</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;skipping field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">field_conf</span> <span class="o">=</span> <span class="n">fields_conf</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">field_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">is_optional</span><span class="p">:</span>
            <span class="n">new_fields_values_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">date_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">field_value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">field_conf</span><span class="o">.</span><span class="n">date_format</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">datetime_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">field_value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">field_conf</span><span class="o">.</span><span class="n">datetime_format</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">var_to_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">var_to_str</span><span class="p">(</span><span class="n">field_value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_field_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">field_value</span><span class="p">)</span>

        <span class="n">field_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;^</span><span class="si">{</span><span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span><span class="si">}</span><span class="s2">$&quot;</span>  <span class="c1"># Exact pattern</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">field_pattern</span><span class="p">,</span> <span class="n">new_field_value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39; value: &#39;</span><span class="si">{</span><span class="n">new_field_value</span><span class="si">}</span><span class="s2">&#39;. It does not match pattern: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>
        <span class="n">new_fields_values_dict</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_field_value</span>
    <span class="k">return</span> <span class="n">new_fields_values_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.process_parsed_fields_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_parsed_fields_values</span><span class="p">(</span><span class="n">parsed_fields</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Process fields values dictionary obtained from parsing a file path
:param parsed_fields: A dictionary of parsed fields values in string format.
:return: A processed dictionary of fields with converted values depending on each FieldConf definition.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_parsed_fields_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_fields</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process fields values dictionary obtained from parsing a file path</span>
<span class="sd">    :param parsed_fields: A dictionary of parsed fields values in string format.</span>
<span class="sd">    :return: A processed dictionary of fields with converted values depending on each FieldConf definition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_parsed_fields</span> <span class="o">=</span> <span class="n">parsed_fields</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_value</span> <span class="ow">in</span> <span class="n">new_parsed_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39;. Valid fields are: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">field_conf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>

        <span class="n">field_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;^</span><span class="si">{</span><span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span><span class="si">}</span><span class="s2">$&quot;</span>  <span class="c1"># Exact pattern</span>
        <span class="k">if</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">is_optional</span><span class="p">:</span>
            <span class="n">field_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;^</span><span class="si">{</span><span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span><span class="si">}</span><span class="s2">|$&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">field_pattern</span><span class="p">,</span> <span class="n">field_value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39; value: &#39;</span><span class="si">{</span><span class="n">field_value</span><span class="si">}</span><span class="s2">&#39;. It does not match pattern: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">field_conf</span><span class="o">.</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">date_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">date_format</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">datetime_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">datetime_format</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">str_to_var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_field_value</span> <span class="o">=</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">str_to_var</span><span class="p">(</span><span class="n">field_value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_field_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">field_value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new_field_value</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">field_conf</span><span class="o">.</span><span class="n">is_optional</span><span class="p">:</span>
            <span class="n">new_field_value</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">new_parsed_fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_field_value</span>
    <span class="k">return</span> <span class="n">new_parsed_fields</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.replace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">replace</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a copy of the current object replacing attributes with the given keyword arguments</p>
<p>:param kwargs: Attributes to be replaced, same arguments as used for PathBuilder instantiation
:return: A PathBuilder instance</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a copy of the current object replacing attributes with the given keyword arguments</span>

<span class="sd">    :param kwargs: Attributes to be replaced, same arguments as used for PathBuilder instantiation</span>
<span class="sd">    :return: A PathBuilder instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default_parent_template</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="s2">&quot;template&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;template&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span>
        <span class="n">default_parent_template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_template</span>
    <span class="k">if</span> <span class="s2">&quot;parent_template&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;parent_template&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_parent_template</span>
    <span class="k">if</span> <span class="s2">&quot;fields&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span>
    <span class="k">if</span> <span class="s2">&quot;default_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;default_field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_field</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="andar.path_builder.PathBuilder.update" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a copy of the current object updating attributes with the given keyword arguments
:param kwargs: Attributes to be updated, same arguments as used for PathBuilder instantiation.
               Fields set to None, will be reset to default, if it is no longer present on the template, it will
               be removed.
:return: A PathBuilder instance</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>andar/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a copy of the current object updating attributes with the given keyword arguments</span>
<span class="sd">    :param kwargs: Attributes to be updated, same arguments as used for PathBuilder instantiation.</span>
<span class="sd">                   Fields set to None, will be reset to default, if it is no longer present on the template, it will</span>
<span class="sd">                   be removed.</span>
<span class="sd">    :return: A PathBuilder instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="s2">&quot;fields&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">fields</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">])</span>
        <span class="n">fields_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">[</span><span class="n">fields</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">fields_names</span> <span class="k">if</span> <span class="n">fields</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]</span>  <span class="c1"># remove fields set to None from input args</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="andar.path_builder.SafePatterns" class="doc doc-heading">
            <code>SafePatterns</code>


</h2>


    <div class="doc doc-contents ">



        <p>Non-greedy patterns</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>andar/path_builder.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SafePatterns</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Non-greedy patterns</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FILENAME</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[-_.a-zA-Z0-9]+?&quot;</span>  <span class="c1"># include filename separators: -_.</span>
    <span class="n">DIRPATH</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[-_.a-zA-Z0-9/]+?&quot;</span>  <span class="c1"># include filename separators: -_. and directory separator: /</span>
    <span class="n">FIELD</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[a-zA-Z0-9]+?&quot;</span>  <span class="c1"># without separator characters</span>
    <span class="n">EXTENSION</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[.a-zA-Z0-9]+?&quot;</span>  <span class="c1"># include dots for sub extensions as &#39;tar.gz&#39;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.indexes"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>